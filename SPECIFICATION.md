# 宿ガチャ 実装仕様書 Ver. 2.0

**選ぶより、ガチャる**

## 1. 概要

本仕様書は、「宿ガチャ」の実装に関する技術仕様を定義します。
関東圏の宿泊施設を対象とした、ガチャ要素を含む新しい宿泊予約体験を提供します。

## 2. 技術スタック

- **フロントエンド**: HTML5, CSS3, JavaScript (Vanilla JS)
- **データ管理**: ローカルストレージ（localStorage）
- **UIフレームワーク**: なし（Pure CSS）
- **演出ライブラリ**: Canvas Confetti（クラッカー演出）
- **アイコン**: 絵文字を使用

## 3. 実装機能一覧

### 3.1 ユーザー向け機能

#### 3.1.1 検索条件入力機能
- 関東エリア選択（プルダウン）: 東京都、神奈川県、千葉県、埼玉県、茨城県、栃木県、群馬県
- 宿泊日選択（日付ピッカー）
- 宿泊数選択（1〜5泊）
- 人数選択（1〜4人）

#### 3.1.2 ガチャプラン選択機能
- 「すぐわかるガチャ」と「当日わかるガチャ」の2プラン表示
- 統一価格表示：10,000円/5,000円
- 品質保証メッセージの表示

#### 3.1.3 ガチャ結果表示機能
- 動画アニメーション付きガチャ演出
- **特別演出**（当たりホテルの場合）:
  - レインボーグラデーション祝福メッセージ
  - クラッカーアニメーション（Canvas Confetti）
  - 「✨ スペシャル」バッジ表示
- 宿泊施設詳細表示
  - ホテル名（当たりホテルはバッジ付き）
  - ホテル画像
  - 住所、電話番号
  - チェックイン/チェックアウト時間
  - 設備・特徴
- **リトライ機能**：最大2回までガチャ引き直し可能
- **友達紹介ボーナス**：2回後の追加ガチャ

#### 3.1.4 観光プラン表示機能
- エリア別観光プランの自動表示
- タイムライン形式での観光スケジュール
- おすすめスポットと所要時間の表示

#### 3.1.5 マイページ機能
- 予約履歴一覧
- 今後の予約（カウントダウン表示付き）
- 過去の予約
- ガチャ回数表示

#### 3.1.6 メニュー機能
- ハンバーガーメニュー（☰）
- ユーザー向け：トップページ、マイページ
- ホテルパートナー向け：管理画面
- ログアウト機能

### 3.2 ホテルパートナー向け機能

#### 3.2.1 管理画面
- ホテル情報表示
- 在庫管理（カレンダー形式）
- 予約一覧表示
- 統計情報（予約数、売上）

## 4. データモデル

### 4.1 予約データ
```javascript
{
  id: string,              // 予約ID
  userId: string,          // ユーザーID（モック）
  planType: string,        // "instant" or "surprise"
  area: string,            // エリア
  checkInDate: string,     // チェックイン日
  nights: number,          // 泊数
  guests: number,          // 人数
  guestName: string,       // 宿泊者名
  hotelId: string,         // ホテルID
  price: number,           // 料金
  status: string,          // "pending" or "revealed"
  attempts: number,        // ガチャ回数（1-3）
  referralBonus: boolean,  // 友達紹介ボーナスフラグ
  createdAt: string,       // 予約作成日時
  revealDate: string       // 結果公開日時（当日わかるガチャの場合）
}
```

### 4.2 ホテルデータ
```javascript
{
  id: string,              // ホテルID
  name: string,            // ホテル名
  type: string,            // ホテルタイプ
  area: string,            // エリア
  address: string,         // 住所
  phone: string,           // 電話番号
  checkIn: string,         // チェックイン時間
  checkOut: string,        // チェックアウト時間
  price: {
    instant: number,       // すぐわかるガチャ価格
    surprise: number       // 当日わかるガチャ価格
  },
  description: string,     // 説明文
  features: string[],      // 特徴・設備
  image: string,          // 画像URL
  placeholder: string     // プレースホルダー画像URL
}
```

## 5. 画面遷移

### 5.1 ユーザー向け画面
1. トップページ（検索条件入力）
2. プラン選択画面
3. ガチャ結果画面（特別演出付き）
4. マイページ（予約一覧）

### 5.2 ホテルパートナー向け画面
1. 管理画面トップ
2. 在庫管理画面
3. 予約一覧画面

## 6. ローカルストレージ構造

```javascript
// 予約データ
localStorage.setItem('yadogacha_reservations', JSON.stringify([...]));

// 現在のユーザー（モック）
localStorage.setItem('yadogacha_current_user', 'user_001');

// ホテルデータ（モック）
localStorage.setItem('yadogacha_hotels', JSON.stringify([...]));
```

## 7. 実装上の制約

- ログイン機能なし（ユーザーIDは固定値を使用）
- 決済機能なし（予約確定ボタンで即座に予約完了）
- プッシュ通知なし
- バックエンドAPIなし（すべてローカルストレージで管理）

## 8. モックデータ

### 8.1 ホテルデータ
関東圏11の宿泊施設：
- **東京都**（3施設）: ベイサイドホテル（当たり枠）、浅草和風旅館、下町ビジネスホテル
- **神奈川県**（1施設）: 箱根湯本温泉リゾート
- **千葉県**（1施設）: 成田エアポートホテル
- **埼玉県**（1施設）: 大宮パレスホテル
- **茨城県**（1施設）: 水戸プラザホテル
- **栃木県**（3施設）: 日光東照宮ホテル、鬼怒川温泉ホテル（当たり枠）、那須ログコテージ
- **群馬県**（1施設）: 草津温泉リゾート

### 8.2 特別演出対象
- hotel_001: 東京ベイサイドホテル
- hotel_010: 鬼怒川温泉ホテル

### 8.3 観光プラン
各県別の観光プランデータを用意

## 9. レスポンシブデザイン

- スマートフォン優先のデザイン
- ブレークポイント: 768px
- タッチ操作に最適化されたUI

## 10. 今後の拡張予定

- ユーザー認証機能の実装
- Stripe決済機能の統合
- バックエンドAPI（Node.js + Express）の実装
- プッシュ通知機能の追加
- 実際の宿泊施設データとの連携